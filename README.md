# Обновление статусов ПОС

## Описание
В текущей реализации системы ДЕЛО рубрика "Статус ПОС" устанавливается вручную, а без установки этого статуса не происходит выгрузка на витринну данных ПОС.
Данное приложение предназначено для автоматического обновления статусов ПОС в зависимости от статуса ССТУ. Программа выполняет следующие основные функции:

1. Получение конфигурации и параметров для выполнения запросов.
2. Подключение к серверу ДЕЛО через GraphQL API.
3. Получение и обработка данных.
4. Формирование и выполнение мутаций для обновления статусов ПОС.

## Установка

1. Склонируйте репозиторий.
2. Установите необходимые зависимости:

    ```bash
    pip install -r requirements.txt
    ```

## Конфигурация

### processing_config.json 

- **statusMapping**: Сопоставление статусов ССТУ со статусами ПОС.
- **dateRange**: Параметры для настройки диапазона дат.
    - **useFixedDates**: Булево значение, указывающее, следует ли использовать фиксированные даты.
    - **startDate**: Начальная дата в формате `YYYY-MM-DD HH:MM:SS`, если `useFixedDates` установлено в true.
    - **endDate**: Конечная дата в формате `YYYY-MM-DD HH:MM:SS`, если `useFixedDates` установлено в true.
    - **maxDateRangeDays**: Максимальный диапазон дат в днях. Используется для проверки и корректировки диапазона дат.
- **pagination**: Параметры для настройки пагинации.
    - **pageSize**: Количество записей на одной странице запроса.
- **utcOffsetHours**: Смещение UTC в часах для локального часового пояса.

### connection_config.json

- **login_url**: URL для выполнения входа на сервер ДЕЛО.
- **logout_url**: URL для выполнения выхода с сервера ДЕЛО.
- **graphql_endpoint**: URL для выполнения GraphQL запросов.
- **username**: Имя пользователя для входа.
- **password**: Пароль пользователя для входа.
- **app**: Название приложения для аутентификации.

## Логирование
Приложение использует библиотеку `logging` для логирования. Логи сохраняются в директории `logs`. Важные сообщения выводятся в консоль для удобства мониторинга.

- Основной лог: `logs/log_<date>.log`
- Лог ошибок: `logs/error.log`

## Запуск
Приложение можно запускать вручную или настроить его на автоматический запуск по расписанию (например, с помощью cron).

## Дополнительные рекомендации
Реализовать обработку ответов мутаций. Логировать количество успешно обработанных записей и регистрировать ошибки, включая их содержание.
Добавить оповещение на электронную почту в случае ошибок.
